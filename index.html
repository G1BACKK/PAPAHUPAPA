<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Buy Product</title>
</head>
<body>
  <h2>Buy Product for â‚¹1</h2>
  <button onclick="payNow()">Buy Now</button>

  <!-- Load Cashfree SDK -->
  <script src="https://sdk.cashfree.com/js/v3/cashfree.js"></script>

  <script>
    async function payNow() {
      try {
        const response = await fetch("https://papa-mode.onrender.com/create-order", {
          method: "POST"
        });

        if (!response.ok) {
          throw new Error("Failed to create order");
        }

        const data = await response.json();

        const cashfree = Cashfree({ mode: "production" }); // use "sandbox" for test

        cashfree.checkout({
          paymentSessionId: data.payment_session_id,
          redirectTarget: "_self"
        });
      } catch (err) {
        console.error("Error:", err);
        alert("Payment failed. Try again.");
      }
    }
  </script>
</body>
</html>
